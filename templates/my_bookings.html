{% extends "base.html" %}
{% block title %}My Bookings | TripMoreee{% endblock %}

{% block content %}

<style>

.page-hero{
    background: linear-gradient(rgba(0,0,0,0.8),rgba(0,0,0,0.8)),
    url("https://images.unsplash.com/photo-1502920917128-1aa500764cbd") center/cover;
    height:40vh;
    display:flex;
    align-items:center;
    justify-content:center;
    color:white;
    text-align:center;
}

.page-hero h1{
    font-size:42px;
}

.booking-section{
    background:#f8f5ef;
    padding:80px 20px;
}

.invoice{
    max-width:1000px;
    margin:40px auto;
    background:white;
    padding:40px;
    border-radius:18px;
    box-shadow:0 20px 50px rgba(0,0,0,0.1);
    animation: fadeIn 1s ease;
}

.invoice-header{
    display:flex;
    justify-content:space-between;
    margin-bottom:30px;
}

.company{
    font-size:20px;
    font-weight:600;
    color:gold;
}

.status{
    padding:6px 14px;
    border-radius:20px;
    font-size:14px;
    font-weight:500;
}

.status.active{ background:#d4edda; color:#155724; }
.status.completed{ background:#d1ecf1; color:#0c5460; }
.status.cancelled{ background:#f8d7da; color:#721c24; }

.section-title{
    margin-top:30px;
    font-weight:600;
    border-bottom:2px solid #eee;
    padding-bottom:5px;
}

.details p{
    margin:6px 0;
    font-size:14px;
}

.table{
    width:100%;
    border-collapse:collapse;
    margin-top:15px;
}

.table th{
    background:black;
    color:white;
    padding:10px;
}

.table td{
    padding:10px;
    border-bottom:1px solid #eee;
    text-align:center;
}

.total-box{
    margin-top:25px;
    text-align:right;
    font-size:18px;
    font-weight:600;
}

.no-booking{
    text-align:center;
    font-size:18px;
    margin-top:60px;
}

@keyframes fadeIn{
    from{opacity:0;}
    to{opacity:1;}
}

</style>

<div class="page-hero">
    <h1>üìú My Booking Invoices</h1>
</div>

<div class="booking-section">

{% if bookings %}

    {% for item in bookings %}

    {% set total = 0 %}

    <div class="invoice">

        <div class="invoice-header">
            <div>
                <div class="company">TripMoreee Travel Pvt Ltd</div>
                <div>Invoice ID: #{{ item.booking.id }}</div>
                <div>Destination: {{ item.booking.destination }}</div>
            </div>

            <div>
                <span class="status {{ item.booking.status }}">
                    {{ item.booking.status|capitalize }}
                </span>
            </div>
        </div>

        <!-- HOTEL -->
        {% if item.hotel %}
        <div class="section-title">üè® Hotel Details</div>
        <div class="details">
            <p><strong>Hotel:</strong> {{ item.hotel.hotel_name }}</p>
            <p><strong>Check-In:</strong> {{ item.hotel.check_in }}</p>
            <p><strong>Check-Out:</strong> {{ item.hotel.check_out }}</p>
            <p><strong>Price:</strong> ‚Çπ {{ item.hotel.price }}</p>
        </div>
        {% set total = total + item.hotel.price %}
        {% endif %}

        <!-- TRANSPORT -->
        {% for t in item.transports %}
        <div class="section-title">üöç Transport Details</div>

        <table class="table">
            <tr>
                <th>Type</th>
                <th>From</th>
                <th>To</th>
                <th>Persons</th>
                <th>Price</th>
            </tr>
            <tr>
                <td>{{ t.transport.transport_type|capitalize }}</td>
                <td>{{ t.transport.source }}</td>
                <td>{{ t.transport.destination }}</td>
                <td>{{ t.transport.persons }}</td>
                <td>‚Çπ {{ t.transport.price }}</td>
            </tr>
        </table>

        {% set total = total + t.transport.price %}

        {% if t.spots %}
        <div class="details">
            <p><strong>Selected Hype Spots:</strong></p>
            <ul>
                {% for s in t.spots %}
                <li>Spot ID: {{ s.spot_id }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}

        {% endfor %}

        <!-- CAB -->
        {% if item.cab %}
        <div class="section-title">üöñ Cab Details</div>
        <div class="details">
            <p><strong>Total KM:</strong> {{ item.cab.total_km }} km</p>
            <p><strong>Price:</strong> ‚Çπ {{ item.cab.price }}</p>
        </div>
        {% set total = total + item.cab.price %}
        {% endif %}

        <!-- TOTAL -->
        <div class="total-box">
            Grand Total: ‚Çπ {{ total }}
        </div>

    </div>

    {% endfor %}

{% else %}

    <div class="no-booking">
        No bookings yet üòï
    </div>

{% endif %}

</div>

{% endblock %}
