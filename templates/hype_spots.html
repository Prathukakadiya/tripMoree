<!DOCTYPE html>
<html>
<head>
<title>Smart Multi Day Trip</title>

<style>
body{
    margin:0;
    font-family:'Segoe UI',sans-serif;
    background:linear-gradient(135deg,#1e3c72,#2a5298);
    color:white;
}
.container{
    max-width:1000px;
    margin:auto;
    padding:30px;
}
.glass{
    background:rgba(255,255,255,0.15);
    backdrop-filter:blur(15px);
    padding:20px;
    border-radius:15px;
    margin-bottom:25px;
    border:1px solid rgba(255,255,255,0.3);
}
.preset-grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(150px,1fr));
    gap:10px;
    margin-bottom:10px;
}
.preset-card{
    background:rgba(255,255,255,0.2);
    padding:10px;
    border-radius:10px;
    cursor:pointer;
    text-align:center;
    transition:.3s;
}
.preset-card:hover{
    transform:scale(1.05);
    background:rgba(255,255,255,0.35);
}
.preset-card.active{
    border:2px solid gold;
    box-shadow:0 0 15px gold;
}
.spot-grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
    gap:8px;
}
button{
    padding:12px 30px;
    border:none;
    border-radius:30px;
    background:linear-gradient(45deg,#ff512f,#dd2476);
    color:white;
    font-size:16px;
    cursor:pointer;
}
</style>
</head>
<body>

<div class="container">

<form method="POST"
      action="{{ url_for('book_cab', hotel_booking_id=hotel_booking_id) }}">

<div class="glass">
<label><strong>Total Days:</strong></label><br>
<input type="number" name="total_days" id="total_days" min="1" required>
</div>

<div id="dayContainer"></div>

<div style="text-align:center;">
    <div class="glass">
<h3>ðŸš• Select Cab</h3>

{% for cab in transports %}
    <label>
        <input type="radio" name="cab_id"
               value="{{ cab.id }}" required>
        {{ cab.vehicle_name }}
        (â‚¹{{ cab.price_per_km }}/km)
    </label><br>
{% endfor %}
</div>

<button type="submit">ðŸš• Confirm Booking</button>
</div>

</form>
</div>

<script>

document.getElementById("total_days")
.addEventListener("change", function(){
    generateDays(parseInt(this.value));
});

function generateDays(days){

    const container=document.getElementById("dayContainer");
    container.innerHTML="";

    for(let i=1;i<=days;i++){

        let div=document.createElement("div");
        div.className="glass";

        div.innerHTML=`
        <h3>ðŸ“… Day ${i}</h3>

        <div class="preset-grid">

            <div class="preset-card active"
                 onclick="setTime(${i},'09:00','17:00',this)">
            â˜€ Morning<br>9AM - 5PM
            </div>

            <div class="preset-card"
                 onclick="setTime(${i},'10:00','19:00',this)">
            ðŸŒ‡ Full Day<br>10AM - 7PM
            </div>

            <div class="preset-card"
                 onclick="setTime(${i},'15:00','22:00',this)">
            ðŸŒ™ Evening<br>3PM - 10PM
            </div>

        </div>

        <!-- Hidden time inputs -->
        <input type="hidden" name="arrival_time_${i}" id="arrival_${i}" value="09:00">
        <input type="hidden" name="departure_time_${i}" id="departure_${i}" value="17:00">

        <h4>Select Spots</h4>

        <div class="spot-grid">
        {% for s in spots %}
            <label>
            <input type="checkbox"
                   name="day_${i}_spots"
                   value="{{ s.id }}">
            {{ s.spot_name }}
            </label>
        {% endfor %}
        </div>

        <br>

        Pickup:
        <select name="pickup_type_${i}">
            <option value="hotel">Hotel</option>
            <option value="airport">Airport</option>
            <option value="custom">Custom</option>
        </select>

        Drop:
        <select name="drop_type_${i}">
            <option value="hotel">Hotel</option>
            <option value="airport">Airport</option>
            <option value="custom">Custom</option>
        </select>
        `;

        container.appendChild(div);
    }
}

function setTime(day, arrival, departure, element){

    document.querySelectorAll(
        `#arrival_${day}`
    )[0].value = arrival;

    document.querySelectorAll(
        `#departure_${day}`
    )[0].value = departure;

    // highlight active
    let parent = element.parentElement;
    parent.querySelectorAll(".preset-card")
          .forEach(x=>x.classList.remove("active"));

    element.classList.add("active");
}

</script>

</body>
</html>
